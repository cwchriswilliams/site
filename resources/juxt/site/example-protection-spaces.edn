;; Copyright Â© 2022, JUXT LTD.

;; Depends on juxt.site.resources.protection-space/dependency-graph
{"https://example.org/protection-spaces/basic"
 {:deps #{:juxt.site.init/system
          "https://example.org/actions/put-protection-space"
          "https://example.org/permissions/system/put-protection-space"}
  :create
  {:juxt.site/subject-id "https://example.org/subjects/system"
   :juxt.site/action-id "https://example.org/actions/put-protection-space"
   :juxt.site/input
   {:xt/id "https://example.org/protection-spaces/basic/wonderland"
    :juxt.site/canonical-root-uri "https://example.org"
    :juxt.site/realm "Wonderland"       ; optional
    :juxt.site/auth-scheme "Basic"}}}

 "https://example.org/protection-spaces/bearer"
 {:deps #{:juxt.site.init/system
          "https://example.org/actions/put-protection-space"
          "https://example.org/permissions/system/put-protection-space"}
  :create
  {:juxt.site/subject-id "https://example.org/subjects/system"
   :juxt.site/action-id "https://example.org/actions/put-protection-space"
   :juxt.site/input
   {:xt/id "https://example.org/protection-spaces/bearer"
    :juxt.site/auth-scheme "Bearer"}}}}
